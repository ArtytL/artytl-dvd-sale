<script>
  // ‡πÇ‡∏î‡πÄ‡∏°‡∏ô API ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (Vercel)
  const ENDPOINT = "https://artytl-dvd-sale.vercel.app/api/order-email";

  const form = document.getElementById("order-form");
  const emailInput = document.getElementById("email");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = (emailInput.value || "").trim();
    if (!email) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≤");

    try {
      const res = await fetch(ENDPOINT, {
        method: "POST",                                // üî• ‡∏£‡∏∞‡∏ö‡∏∏ POST ‡∏ä‡∏±‡∏î ‡πÜ
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email })                // üî• ‡∏™‡πà‡∏á JSON ‡πÑ‡∏õ
      });

      const txt = await res.text();                   // debug ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
      let json; try { json = JSON.parse(txt); } catch {}
      if (!res.ok) throw new Error(json?.error || `HTTP ${res.status}`);

      alert("‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß!");
    } catch (err) {
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message);
      console.error("fetch error:", err);
    }
  });
</script>
